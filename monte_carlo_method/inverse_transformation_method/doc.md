# 逆関数法

### 前提

1変量の確率変数 $X$ が確率密度関数 $p_X(x)$ と分布関数 $F_X(x)$ をもつとする.

### 条件

$F_X(x)$ の逆関数 $F_X^{-1}(x)$ が陽に得られる場合
> 💡分布関数の逆関数を分位関数 (quantile function) と呼ぶ

### 結論

以下の手順で, $X$ の乱数を生成できる

1. $U(0,1)$ から一様乱数 $u$ を1つ得る.
2. $x=F_X^{-1}(u)$ とする.

### 理由

確率変数 $F_X^{-1}(U)$ の分布関数 $F(x) = P(F_X^{-1}(U) < x)$ が $F_X(x)$ に一致することを示せばよい.

$$
F(x) = P(F_X^{-1}(U) < x) = P(U < F_X(x)) = F_X(x)$$

> 💡 $P(U \leq F_X(x))$ は, 一様分布変数 $U$ が区間 $[0,1]$ 上の値 $F_X(x)$ 以下になる確率を意味する.
$U$ が $[0,1]$ 上で一様分布しているため, この確率は区間の長さに等しく, したがって $F_X(x)$ になる.

### 具体例

- 指数分布: $\textit{Exp}(\lambda)$
  - $p_X(x) = \lambda \exp(-\lambda x)$
  - $F_X(x) = 1 - \exp(-\lambda x)$
  - $F_X^{-1}(x) = -\frac{1}{\lambda}\log(1 - x)$

- コーシー分布:
  - 工事中🚨
- レイリー分布:
  - 工事中🚨